<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Colorfy Options</title>
    <link rel="stylesheet" type="text/css" href="./options.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="options-container">
      <!-- Header Section -->
      <div class="header-section">
        <h1>Colorfy Settings</h1>
        <p class="subtitle">Customize your color picking experience</p>
      </div>

      <!-- General Settings -->
      <div class="settings-section">
        <h2 class="section-title">General Settings</h2>
        <p class="section-description">Configure basic appearance and behavior preferences</p>
        
        <div class="option">
          <div class="option-info">
            <label for="color-scheme">Color Scheme</label>
            <div class="option-description">Choose how Colorfy appears in your browser</div>
          </div>
          <div class="option-control">
            <select id="color-scheme">
              <option value="system">System Default</option>
              <option value="dark">Dark Mode</option>
              <option value="light">Light Mode</option>
            </select>
          </div>
        </div>

        <div class="option">
          <div class="option-info">
            <label for="use-gradients">Enable Gradient Colors</label>
            <div class="option-description">Allow gradient color combinations in the color picker</div>
          </div>
          <div class="option-control">
            <input type="checkbox" id="use-gradients" checked />
          </div>
        </div>

        <div class="option">
          <div class="option-info">
            <label for="dev-mode">Developer Mode</label>
            <div class="option-description">Show advanced options and debugging features</div>
          </div>
          <div class="option-control">
            <input type="checkbox" id="dev-mode" />
            <small>Enables saved items management</small>
          </div>
        </div>
      </div>

      <!-- Storage Management -->
      <div class="settings-section">
        <h2 class="section-title">Storage Management</h2>
        <p class="section-description">Monitor and manage your saved colors and extension data</p>
        
        <div class="option">
          <div class="option-info">
            <label for="storage-usage">Storage Usage</label>
            <div class="option-description">Current storage usage - unlimited storage enabled</div>
          </div>
          <div class="option-control">
            <div id="storage-info">
              <div id="storage-bar-container">
                <div id="storage-bar">
                  <div id="storage-fill"></div>
                </div>
                <span id="storage-text" class="message-template">Loading...</span>
              </div>
              <div id="storage-details">
                <small id="storage-stats">Calculating storage usage...</small>
              </div>
            </div>
          </div>
        </div>

        <div class="option" id="migration-option" style="display: none;">
          <div class="option-info">
            <label for="migration-tools">Data Migration Tools</label>
            <div class="option-description">
              <div id="migration-description">Migrate from old storage format or manage migration backups</div>
              <div id="backup-info" style="display: none; margin-top: 8px; font-size: 12px; color: #666;">
                <strong>Migration Backup:</strong> <span id="backup-size-text">Calculating...</span> - 
                This backup can be safely deleted after confirming your data migrated correctly. 
                Deleting it will free up storage space.
              </div>
            </div>
          </div>
          <div class="option-control">
            <div id="migration-buttons">
              <button id="manual-migration-btn" type="button" style="display: none;">Run Migration</button>
              <button id="delete-backup-btn" type="button" style="display: none;">Delete Backup</button>
            </div>
          </div>
        </div>

        <div class="option">
          <div class="option-info">
            <label for="manage-storage">Manage Saved Colors</label>
            <div class="option-description">View and selectively delete saved colors by website</div>
          </div>
          <div class="option-control">
            <button id="manage-storage-btn" type="button">Manage Storage</button>
          </div>
        </div>

        <div class="option">
          <div class="option-info">
            <label for="export-import">Export / Import Data</label>
            <div class="option-description">Backup your colors and settings to transfer between browsers</div>
          </div>
          <div class="option-control">
            <div class="export-import-buttons">
              <button id="export-data-btn" type="button">Export Data</button>
              <button id="import-data-btn" type="button">Import Data</button>
              <input type="file" id="import-file-input" accept=".json" style="display: none;">
            </div>
            <small style="display: block; margin-top: 8px; color: #666;">
              <span class="material-symbols-outlined icon-lightbulb" style="font-size: 16px; vertical-align: middle; margin-right: 4px;">lightbulb</span>Export creates a JSON file with all your saved colors and settings
            </small>
          </div>
        </div>

        <div class="option">
          <div class="option-info">
            <label for="clear-data">Reset All Data</label>
            <div class="option-description">Completely reset the extension to factory defaults</div>
          </div>
          <div class="option-control">
            <button id="clear_all_changes">Clear All Data</button>
            <small><span class="material-symbols-outlined icon-warning" style="font-size: 16px; vertical-align: middle; margin-right: 4px;">warning</span>This cannot be undone</small>
          </div>
        </div>
      </div>

      <!-- Actions Section -->
      <div class="actions-section">
        <h2 class="section-title">Save Changes</h2>
        <p class="section-description">Apply your settings changes or restore defaults</p>
        <div class="buttons">
          <button id="save-settings">Save Settings</button>
          <button id="reset-settings">Reset to Default</button>
        </div>
      </div>
    </div>

    <!-- Storage Management Modal -->
    <div id="storage-modal" class="modal-overlay" style="display: none;">
      <div class="modal-container">
        <div class="modal-header">
          <h2>Manage Saved Colors</h2>
          <button id="storage-modal-close" class="close-btn" type="button">&times;</button>
        </div>
        
        <div class="modal-body">
          <!-- Current Usage Overview -->
          <div class="storage-overview">
            <h3>Storage Usage</h3>
            <div class="usage-display">
              <div class="usage-bar">
                <div id="modal-storage-fill" class="usage-fill"></div>
              </div>
              <div class="usage-text">
                <span id="modal-storage-text" class="message-template">Loading...</span>
                <span id="modal-storage-details" class="message-template">Calculating usage...</span>
              </div>
            </div>
          </div>

          <!-- Data Categories -->
          <div class="storage-categories">
            <h3>Saved Colors by Website</h3>
            <p class="info-note">
              <span class="material-symbols-outlined icon" style="font-size:16px; vertical-align:middle; margin-right:6px;">info</span>
              Original styles (default page appearance) are not shown in expandable lists and are only removed when deleting the entire website.
            </p>
            
            <!-- Search Input -->
            <div class="search-container">
              <input type="text" id="website-search" placeholder="Search websites..." class="search-input">
              <span class="search-icon material-symbols-outlined">search</span>
            </div>
            
            <div class="category-controls">
              <button id="select-all-btn" type="button">Select All</button>
              <button id="select-none-btn" type="button">Select None</button>
            </div>

            <div id="categories-list" class="categories-container">
              <!-- Websites will be populated by JavaScript -->
            </div>
          </div>
        </div>

        <div class="modal-footer">
          <div class="modal-buttons">
            <button id="storage-modal-cancel" class="secondary-btn" type="button">Cancel</button>
            <button id="storage-modal-apply" class="danger-btn" type="button" disabled>Delete Selected</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Message Templates (Hidden) -->
    <div id="message-templates" style="display: none;">
      <!-- Storage Messages -->
      <div id="msg-unlimited-storage" class="message-template">
        <span class="material-symbols-outlined icon">storage</span>
        <span class="text">Unlimited Storage</span>
      </div>
      
      <div id="msg-storage-info" class="message-template">
        <span class="material-symbols-outlined icon">storage</span>
        <span class="text">Stored locally on your device - no browser storage limits</span>
      </div>
      
      <div id="msg-storage-warning" class="message-template">
        <span class="material-symbols-outlined icon icon-warning">warning</span>
        <span class="text">Storage nearly full! Consider clearing old data.</span>
      </div>

      <!-- Notification Messages -->
      <div id="msg-settings-saved" class="message-template success">
        <span class="material-symbols-outlined icon">check_circle</span>
        <span class="text">Settings saved successfully!</span>
      </div>
      
      <div id="msg-settings-reset" class="message-template info">
        <span class="material-symbols-outlined icon">refresh</span>
        <span class="text">Settings reset to defaults!</span>
      </div>

      <!-- Export/Import Messages -->
      <div id="msg-exporting" class="message-template">
        <span class="material-symbols-outlined icon">download</span>
        <span class="text">Exporting...</span>
      </div>
      
      <div id="msg-export-success" class="message-template success">
        <span class="material-symbols-outlined icon">check_circle</span>
        <span class="text">Exported!</span>
      </div>
      
      <div id="msg-export-failed" class="message-template error">
        <span class="material-symbols-outlined icon">error</span>
        <span class="text">Export Failed</span>
      </div>
      
      <div id="msg-importing" class="message-template">
        <span class="material-symbols-outlined icon">upload</span>
        <span class="text">Importing...</span>
      </div>
      
      <div id="msg-import-success" class="message-template success">
        <span class="material-symbols-outlined icon">check_circle</span>
        <span class="text">Imported!</span>
      </div>
      
      <div id="msg-import-failed" class="message-template error">
        <span class="material-symbols-outlined icon">error</span>
        <span class="text">Import Failed</span>
      </div>
      
      <div id="msg-invalid-file" class="message-template error">
        <span class="material-symbols-outlined icon">error</span>
        <span class="text">Invalid File</span>
      </div>
      
      <div id="msg-invalid-json" class="message-template error">
        <span class="material-symbols-outlined icon">error</span>
        <span class="text">Invalid JSON</span>
      </div>

      <!-- Migration Messages -->
      <div id="msg-running-migration" class="message-template">
        <span class="material-symbols-outlined icon">sync</span>
        <span class="text">Running Migration...</span>
      </div>
      
      <div id="msg-run-migration" class="message-template">
        <span class="text">Run Migration</span>
      </div>
      
      <div id="msg-deleting" class="message-template">
        <span class="material-symbols-outlined icon">delete</span>
        <span class="text">Deleting...</span>
      </div>
      
      <div id="msg-delete-backup" class="message-template">
        <span class="text">Delete Backup</span>
      </div>
      
      <div id="msg-migration-completed" class="message-template success">
        <span class="text">Migration completed. You can manage the backup below.</span>
      </div>

      <!-- Search Results -->
      <div id="msg-search-results" class="message-template info">
        <span class="material-symbols-outlined icon">bar_chart</span>
        <span class="text-template">Showing {count} result{plural} for "{term}"{empty}</span>
      </div>
      
      <div id="msg-no-results" class="message-template">
        <span class="text">- Try a different search term</span>
      </div>

      <!-- Settings Category -->
      <div id="msg-settings-category" class="message-template">
        <span class="material-symbols-outlined icon">settings</span>
        <div class="content">
          <div class="name">Extension Settings & System Data</div>
          <div class="description">Cannot be deleted individually (use "Clear All Data" to reset)</div>
        </div>
      </div>

      <!-- Expand Buttons -->
      <div id="msg-expand-more" class="message-template">
        <span class="material-symbols-outlined icon">expand_more</span>
      </div>
      
      <div id="msg-expand-less" class="message-template">
        <span class="material-symbols-outlined icon">expand_less</span>
      </div>
    </div>

    <script src="options.js"></script>
  </body>
</html>
